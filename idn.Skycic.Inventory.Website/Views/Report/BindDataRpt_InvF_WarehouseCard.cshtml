@model List<Rpt_InvF_WarehouseCard>

<style>
    .hidden {
        display: none;
    }
</style>

<div class="col-xs-12 layout-bot-top-16" style="">
    <div class="row">
        <div class="col-6">
            @*<a class="btn btn-nc-button" href="javascript:;" onclick="Print();" style=""><i class="fas fa-print" aria-hidden="true"></i> In</a>
        <a class="btn btn-nc-button" href="javascript:;" onclick="Export();" style=""><i class="far fa-file-excel" aria-hidden="true"></i> Xuất Excel</a>*@
            @RenderItemFormat("BTN_BC_THE_KHO_PRINT", "<a class=\"btn btn-nc-button\" style=\"line-height: 13px; color: #000000\" onclick=\"Print()\" href=\"javascript:void(0);\" style=\"\"><i class=\"fas fa-print\" aria-hidden=\"true\" style=\"margin-right: 7px\"></i> In</a>", "", "")
            @RenderItemFormat("BTN_BC_THE_KHO_EXCEL", "<a class=\"btn btn-nc-button\" style=\"line-height: 13px; color: #000000\" onclick=\"Export()\" href=\"javascript:void(0);\" style=\"\"><i class=\"fas fa-file-excel\" aria-hidden=\"true\" style=\"margin-right: 7px\"></i> Xuất Excel</a>", "", "")
        </div>
        <div class="col-6">
            @*<span style="float: right; line-height: 30px">
                <a class="btn font-color mybtn-Button-1" data-toggle="dropdown" aria-expanded="false" style="font-size: 13px; position: relative; float: right"><i class="fas fa-ellipsis-v"></i></a>
                <ul id="togglecolumn" class="dropdown-menu ulshowdata" role="menu" style="right: 0; width: 30px; left: none; box-shadow: rgb(0, 0, 0) 2px 2px 6px;"></ul>
            </span>*@
        </div>
    </div>
</div>
<div class="panel-body no-padding" id="panel-body" style="padding-left: 0px; padding-right: 0px;">
    <aside class="col-xs-12 layout-table no-padding">
        @Html.AntiForgeryToken()
        <div class="scrollable-horizontal padding-left-0 padding-right-0" style="padding-top: 0!important;">
            <div style="width: 100%; float: left;">
                <table id="dynamic-table-thead" class="table table-bordered table-thead table-cus table-bottom-0 no-margin">
                    <thead>
                        <tr class="trthead">
                            <th fieldId="DOCNO" fieldName="Số chứng từ" fieldActive="0" class="text-center cell-120">
                                @("Số chứng từ".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="DATEDOC" sorttype="T" fieldName="Ngày duyệt" fieldActive="0" class="text-center cell-120">
                                @("Ngày duyệt".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="INVENTORYACTIONDESC" sorttype="T" fieldName="Diễn giải" fieldActive="0" class="text-center cell-150">
                                @("Diễn giải".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="INVNAME" sorttype="T" fieldName="Kho" fieldActive="0" class="text-center cell-120">
                                @("Kho".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="QTYTRANS" sorttype="T" fieldName="Số lượng" fieldActive="0" class="text-center cell-120">
                                @("Số lượng".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="TOTALQTYINV" fieldName="Tồn kho" fieldActive="0" class="text-center cell-120">
                                @("Tồn kho".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="INVCODE" fieldName="Vị trí tồn" fieldActive="0" class="text-center cell-300">
                                @("Vị trí tồn".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="INVFCFINCODE01" fieldName="Số hợp đồng" fieldActive="1" class="text-center cell-150">
                                @("Số hợp đồng".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="INVFCFINCODE02" fieldName="Nhập.Số Container" fieldActive="1" class="text-center cell-150">
                                @("Nhập.Số Container".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="INVFCFINCODE03" fieldName="Nhập.Biển số xe" fieldActive="1" class="text-center cell-150">
                                @("Nhập.Biển số xe".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="INVFCFOUTCODE01" fieldName="Code xuất khẩu" fieldActive="1" class="text-center cell-150">
                                @("Code xuất khẩu".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="INVFCFOUTCODE02" fieldName="Xuất.Số Container" fieldActive="1" class="text-center cell-150">
                                @("Xuất.Số Container".HtmlItemString("inventory"))
                            </th>
                            <th fieldId="INVFCFOUTCODE03" fieldName="Xuất.Biển số xe" fieldActive="1" class="text-center cell-150">
                                @("Xuất.Biển số xe".HtmlItemString("inventory"))
                            </th>
</thead>
                </table>
            </div>
            <div id="scrollable_1" class="scrollable" style="width: 100%; float: left">
                <table id="dynamic-table-thead-tbody" class="table table-borderedtable-cus table-bottom-0 dynamic-table-tbody dynamic-table-thead-tbody no-margin">
                    <tbody id="table-tbodyID">
                        @if (Model != null && Model.Count > 0)
                        {
                            int stt = 1;
                            foreach (var item in Model)
                            {
                        <tr class="data-item trdata" ProductCode="@item.ProductCode">
                            <td fieldId="DOCNO" fieldActive="0" class="text-center cell-120 text-center">
                                @item.DocNo
                            </td>
                            <td fieldId="DATEDOC" fieldActive="0" class="text-center cell-120">
                                @item.DateDoc
                            </td>
                            <td fieldId="INVENTORYACTIONDESC" fieldActive="0" class="text-left cell-150">
                                @item.InventoryActionDesc
                            </td>
                            <td fieldId="INVNAME" fieldActive="0" class="text-left cell-120">
                                @item.InvName
                            </td>
                            <td fieldId="QTYTRANS" fieldActive="0" class="text-right cell-120 numberic valQtyTrans">
                                @item.QtyTrans
                            </td>
                            <td fieldId="TOTALQTYINV" fieldActive="0" class="text-right cell-120 numberic valTotalQtyInv">
                                @item.TotalQtyInv
                            </td>
                            <td fieldId="INVCODE" fieldActive="0" class="text-left cell-300">
                                @{
                                    var listInv = item.ListInvCode.Split(',');
                                    foreach (var invCode in listInv)
                                    {
                                        if (string.IsNullOrEmpty(invCode)) { continue; }
                                        <span class="badges-sm">@invCode</span>
                                    }
                                }
                            </td>
                            <td fieldId="INVFCFINCODE01" fieldActive="1" class="text-left cell-150">
                                @item.InvFCFInCode01
                            </td>
                            <td fieldId="INVFCFINCODE02" fieldActive="1" class="text-left cell-150">
                                @item.InvFCFInCode02
                            </td>
                            <td fieldId="INVFCFINCODE03" fieldActive="1" class="text-left cell-150">
                                @item.InvFCFInCode03
                            </td>
                            <td fieldId="INVFCFOUTCODE01" fieldActive="1" class="text-left cell-150">
                                @item.InvFCFOutCode01
                            </td>
                            <td fieldId="INVFCFOUTCODE02" fieldActive="1" class="text-left cell-150">
                                @item.InvFCFOutCode02
                            </td>
                            <td fieldId="INVFCFOUTCODE03" fieldActive="1" class="text-left cell-150">
                                @item.InvFCFOutCode03
                            </td>
                        </tr>
                                stt++;
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </aside>
</div>

<script>
    $(document).ready(function () {
        debugger;
        //tablesort();
        $('.scrollable-horizontal').hScroll();
    });
    function tablesort() {
        var listColumns = {
            'DATEDOC': [],
            'INVENTORYACTIONDESC': [],
            'INVNAME': [],
            'QTYTRANS': [],            
            'TOTALQTYINV': [],
            'INVCODE': [],
            'INVFCFINCODE01': [],
            'INVFCFINCODE02': [],
            'INVFCFINCODE03': [],
            'INVFCFOUTCODE01': [],
            'INVFCFOUTCODE02': [],
            'INVFCFOUTCODE03': [],
        };
        var options = {};
        options.Columns = listColumns;
        $('#dynamic-table-thead').table_Sortable(options);
    }
</script>

<script>
    function ChangeProduct(thiz) {
        var targetPrdCode = $(thiz).find('option:selected').attr('productcode');
        var currentRow = $(thiz).parent().parent();
        var targetRow = $(thiz).closest('tbody').find('tr.trdata.hidden[productcode="' + targetPrdCode + '"]')
        $(currentRow).addClass('hidden');
        $(targetRow).find('select[name="UnitCode"]').val(targetPrdCode).prop('selected', true);
        $(targetRow).find('select[name="UnitCode"]').select2({
            minimumResultsForSearch: -1
        });
        $(targetRow).removeClass('hidden');
    }
</script>
